{% assign product = all_products[section.settings.product] %}

{% if section.settings.product == blank %}
  {% assign product = nil %}
{% endif %}

{% assign enable_history = false %}

<script
  type="application/json"
  data-section-type="featured-product"
  data-section-id="{{ section.id }}"
  data-section-data
>
  {%
    render 'product-json',
    enable_history: enable_history,
    product: product
  %}
</script>

<div
  class="
    home-module
    home-featured-product
    {% if section.settings.show_border %}has-border{% endif %}
  "
>
  <div class="home-module-content">
    {% capture product_form_id %}{{- 'product-form-' | append: section.id -}}{% endcapture %}

    <div class="product-wrap clearfix" itemscope itemtype="http://schema.org/Product">
      {% if product != blank %}
        {% form 'product', product, class: 'product', id: product_form_id, data-product-form: '' %}
          {%
            render 'product-blocks',
            product: product,
            section: section,
            form: form,
            form_id: product_form_id,
          %}
        {% endform %}
      {% else %}
        <div class="product" data-product-form>
          {%
            render 'product-blocks',
            product: product,
            section: section,
            form: nil,
            form_id: product_form_id,
          %}
        </div>
      {% endif %}
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Featured product",
  "settings": [
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "checkbox",
      "id": "show_border",
      "label": "Show border",
      "default": false
    },
    {
      "type": "header",
      "content": "Blocks"
    },
    {
      "type": "paragraph",
      "content": "Learn more about [block positioning](https://support.pixelunion.net/hc/en-us/articles/360026416893)"
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "paragraph",
      "content": "Learn more about [media types](https://help.shopify.com/en/manual/products/product-media/product-media-types)"
    },
    {
      "type": "checkbox",
      "id": "enable_zoom",
      "label": "Enable image zoom",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "gallery_enable_video_autoplay",
      "label": "Enable video autoplay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "gallery_enable_video_looping",
      "label": "Enable video looping",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "title",
      "name": "Title",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "top"
        }
      ]
    },
    {
      "type": "vendor",
      "name": "Vendor",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "top"
        }
      ]
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "variant_selection",
      "name": "Variant selection",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "quantity",
      "name": "Quantity",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "gallery",
      "name": "Gallery",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "left"
        }
      ]
    },
    {
      "type": "form",
      "name": "Buy buttons",
      "limit": 1,
      "settings": [
        {
          "type": "paragraph",
          "content": "Customize form features for the product in the products portion of the theme settings."
        },
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "callout",
      "name": "Call to action",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "share",
      "name": "Share",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "label": "Text",
          "default": "<p>Text block</p>"
        },
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "rating",
      "name": "Product rating",
      "limit": 1,
      "settings": [
        {
          "type": "paragraph",
          "content": "To display a rating, add a product rating app. [Learn more](https://apps.shopify.com/product-reviews)"
        },
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    },
    {
      "type": "alignment",
      "name": "App block alignment",
      "settings": [
        {
          "type": "paragraph",
          "content": "Use this block before an app block to set the app block's position. Otherwise, app blocks will inherit the position of the block before them."
        },
        {
          "type": "select",
          "id": "position",
          "label": "Position",
          "options": [
            {
              "value": "top",
              "label": "Center (top)"
            },
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            },
            {
              "value": "bottom",
              "label": "Center (bottom)"
            }
          ],
          "default": "right"
        }
      ]
    }
  ],
  "presets": [
    {
      "category": "Product",
      "name": "Featured product",
      "blocks": [
        {
          "type": "title",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "vendor",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "gallery",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "variant_selection",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "price",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "form",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "description",
          "settings": {
            "position": "top"
          }
        },
        {
          "type": "callout",
          "settings": {
            "position": "top"
          }
        }
      ]
    }
  ],
  "enabled_on": {
    "templates": [
      "index",
      "page"
    ]
  }
}

{% endschema %}